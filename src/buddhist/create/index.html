<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="renderer" content="webkit" />
    <meta name="format-detection" content="telephone=no" />
    <title>新建佛事</title>
  </head>
  <body data-menu-id="event-manage">
    <div class="main-content" id="content-container">
      <div id="main-body">
        <div id="app"></div>
      </div>
    </div>
    <script>
        window.createdData = {{ceremonyMap | safe}};
        // 数据库已经把牌位佛事的地址附言6的全部转为地区18了，不再需要另外处理！！！！
        // 在这里处理默认附言添加的各种问题；需要考虑原来地区添加在第一个或者第三个;并且把原来的地址换成地区，不再使用地址控件；
        // 思路，把原来的固定附言全部删除，重新添加进新的的固定附言；
        // 往生牌位阳上人；往生者；出生日期；往生日期；地区；详细地址；
        // 祈福牌位功德芳名；出生日期；心愿；地区；详细地址；

        (function() {
          // payDetail默认应该是 { content: '', pic: '', video: ''}
          if (window.createdData.payDetail && typeof window.createdData.payDetail === "string") {
            window.createdData.payDetail = { content: '', pic: '', video: ''};
          }

          console.log(window.createdData, 'createData');
        })()


      //   (function() {
      //   // payDetail默认应该是 { content: '', pic: '', video: ''}
      //   if (window.createdData.payDetail && typeof window.createdData.payDetail === "string") {
      //     window.createdData.payDetail = { content: '', pic: '', video: ''};
      //   }
      //   let wsFixFuYan = [
      //     {
      //       inputType: 10,
      //       prompt_text: '请填写功德主姓名（在世）',
      //       name: '阳上人',
      //       is_must: 1,
      //       dataType: 2,
      //       pic_num: 1,
      //       describe: '',
      //       isVerify: 0,
      //       font_length: 5,
      //     },
      //     {
      //       inputType: 11,
      //       prompt_text: '请填写已故者姓名（已去世）',
      //       name: '往生者',
      //       is_must: 1,
      //       dataType: 2,
      //       pic_num: 6,
      //       describe: '',
      //       isVerify: 0,
      //       font_length: 5,
      //     },
      //     {
      //       inputType: 9,
      //       prompt_text: '',
      //       describe: '',
      //       name: '逝者的出生日期',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 0,
      //       isVerify: 0,
      //       font_length: 0,
      //     },
      //     {
      //       inputType: 9,
      //       prompt_text: '',
      //       describe: '',
      //       name: '逝者的往生日期',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 0,
      //       isVerify: 0,
      //       font_length: 0,
      //     },
      //     {
      //       inputType: 18,
      //       prompt_text: '请选择您常用的地区',
      //       name: '地区',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 4,
      //       describe: '',
      //       isVerify: 0,
      //       font_length: 20,
      //     },
      //     {
      //       inputType: 19,
      //       prompt_text: '请填写您的详细地址',
      //       describe: '',
      //       name: '详细地址',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 1,
      //       isVerify: 0,
      //       font_length: 0,
      //     },
      //   ];
      //   let qfFixFuYan = [
      //     {
      //       inputType: 12,
      //       prompt_text: '请填写功德主姓名',
      //       name: '功德芳名',
      //       is_must: 1,
      //       dataType: 2,
      //       pic_num: 6,
      //       describe: '',
      //       isVerify: 0,
      //       font_length: 5,
      //     },
      //     {
      //       inputType: 9,
      //       prompt_text: '',
      //       describe: '',
      //       name: '功德主的出生日期',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 1,
      //       isVerify: 0,
      //       font_length: 0,
      //     },
      //     {
      //       inputType: 18,
      //       prompt_text: '请选择您常用的地区',
      //       name: '地区',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 4,
      //       describe: '',
      //       isVerify: 0,
      //       font_length: 20,
      //     },
      //     {
      //       inputType: 19,
      //       prompt_text: '请填写您的详细地址',
      //       describe: '',
      //       name: '详细地址',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 1,
      //       isVerify: 0,
      //       font_length: 0,
      //     },
      //     {
      //       inputType: 15,
      //       prompt_text: '填写心愿，获菩萨加持，早日实现！',
      //       name: '心愿',
      //       is_must: 0,
      //       dataType: 2,
      //       pic_num: 0,
      //       describe: '',
      //       isVerify: 0,
      //       font_length: 50,
      //     },
      //   ];
      //   console.log(window.createdData, 'createData');
      //   let wsFuYanDefaultType = [10, 11, 9, 9, 6, 19, 18];  // 为什么这里多加了一个6；因为这里原来使用的是地址控件，没有使用地区控件，现在全部替换掉；
      //   let qfFuYanDefaultType = [12, 9, 6, 19, 15, 18];
      //   window.createdData.subdivideStr && window.createdData.subdivideStr.forEach(subdivide => {
      //     if (subdivide.postScript && subdivide.postScript.length) {
      //       if (subdivide.subdivide_type === 2) { // 往生牌位

      //         // 之前设置的那些名称数值需要保留
      //         for(let i=0;i<subdivide.postScript.length;i++) {
      //           let inputTypeKey = wsFuYanDefaultType.indexOf(subdivide.postScript[i].inputType);
      //           if (inputTypeKey > -1 && inputTypeKey !== 2 && inputTypeKey !== 3) {  // 因为出生日期和去世日期没什么设置的，使用默认即可
      //             wsFixFuYan[inputTypeKey] = subdivide.postScript[i];
      //             if (inputTypeKey === 4) { // 地区非必填
      //               wsFixFuYan[inputTypeKey].is_must = 0;
      //             }
      //           }
      //         }

      //         // 删除原来的固定附言
      //         for(let i=0;i<subdivide.postScript.length;i++) {

      //           let inputTypeKey = wsFuYanDefaultType.indexOf(subdivide.postScript[i].inputType);
      //           if (inputTypeKey > -1) {
      //             subdivide.postScript.splice(i, 1);
      //             i--;
      //           }
      //         }
      //         // 添加新的固定附言到开头
      //         subdivide.postScript.unshift(...wsFixFuYan);
      //       }
      //       if (subdivide.subdivide_type === 3) { // 祈福牌位
      //         subdivide.postScript.forEach((pos, key) => {
      //           // 之前设置的那些名称数值需要保留
      //           for(let i=0;i<subdivide.postScript.length;i++) {
      //             let inputTypeKey = qfFuYanDefaultType.indexOf(subdivide.postScript[i].inputType);
      //             if (inputTypeKey > -1 && inputTypeKey !== 1) {

      //               qfFixFuYan[inputTypeKey] = subdivide.postScript[i];
      //               if (inputTypeKey === 4 || inputTypeKey === 2) { // 地区和心愿非必填;
      //                 qfFixFuYan[inputTypeKey].is_must = 0;
      //               }
      //             }
      //           }

      //           // 删除原来的固定附言
      //           for(let i=0;i<subdivide.postScript.length;i++) {
      //             let inputTypeKey = qfFuYanDefaultType.indexOf(subdivide.postScript[i].inputType);
      //             if (inputTypeKey > -1) {
      //               subdivide.postScript.splice(i, 1);
      //               i--;
      //             }
      //           }
      //           // 添加新的固定附言到开头
      //           subdivide.postScript.unshift(...qfFixFuYan);
      //         })
      //       }
      //     }
      //   })
      // })();
    </script>
  </body>
</html>
